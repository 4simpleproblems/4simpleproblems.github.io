<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4SP - HOME</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="/panic-key.js"></script>
    <script src="/url-changer.js"></script>
    
    <style>
        /* This inline style ensures the links are hidden by default before JS loads */
        .logged-in-link, .logged-out-link {
            display: none;
        }

        /* --- STICKY FOOTER & BODY STYLES --- */
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            flex-grow: 1;
        }
        /* A class to prevent scrolling when an overlay is active */
        body.no-scroll {
            overflow: hidden;
        }

        /* --- DEVELOPMENT DISCLAIMER STYLES --- */
        #development-disclaimer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); /* A bit darker to stand out */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 10000; /* Highest z-index to be on top of everything */
            display: none; /* Hidden by default; shown by JS */
            justify-content: center;
            align-items: center;
            font-family: 'PrimaryFont', sans-serif;
            padding: 15px;
            box-sizing: border-box;
        }

        .disclaimer-box {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 10px;
            text-align: center;
            max-width: 550px; /* Wider for more text */
            box-shadow: 0 5px 25px rgba(0,0,0,0.25);
            color: #333;
        }

        .disclaimer-box h2 {
            margin-top: 0;
            font-size: 1.8em;
            text-transform: uppercase;
            color: #6720BD; /* Match theme color */
        }

        .disclaimer-box p {
            font-size: 1.05em;
            line-height: 1.7;
            margin-bottom: 20px;
            text-align: left; /* Better for readability of paragraphs */
        }

        #disclaimer-continue-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background-color: #6720BD;
            color: #fff;
            font-family: 'PrimaryFont', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 10px;
        }

        #disclaimer-continue-btn:hover {
            background-color: #4b138f;
        }


        /* --- MOBILE ASPECT RATIO WARNING STYLES --- */
        #mobile-warning-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            /* The backdrop-filter blurs content behind the element */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px); /* For Safari browser compatibility */
            z-index: 9999;
            display: none; /* Hidden by default; shown by JS */
            justify-content: center;
            align-items: center;
            font-family: 'PrimaryFont', sans-serif;
            padding: 15px;
            box-sizing: border-box;
        }

        .warning-box {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 10px;
            text-align: center;
            max-width: 450px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.25);
            color: #333;
        }

        .warning-box h2 {
            margin-top: 0;
            font-size: 1.8em;
            text-transform: uppercase;
        }

        .warning-box p {
            font-size: 1.05em;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        #continue-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background-color: #6720BD; /* Matches your site's theme color */
            color: #fff;
            font-family: 'PrimaryFont', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #continue-btn:hover {
            background-color: #4b138f; /* A darker shade for the hover effect */
        }


        /* --- STYLES FOR VERSION HISTORY, WHAT'S NEW, & FOOTER --- */
        .timeline-section, .whats-new-section {
            padding: 80px 0;
            text-align: center;
        }

        .whats-new-section {
            padding: 60px 0; /* Reduced padding */
        }

        .timeline-section {
            border-top: 1px solid #eee;
        }

        .whats-new-section {
            border-top: 1px solid #eee;
        }

        .timeline-section h2, .whats-new-section h2 {
            font-size: 2.8em;
            margin-bottom: 20px;
            color: #333;
            text-transform: uppercase;
            font-family: 'PrimaryFont', sans-serif;
            font-weight: 700;
        }

        .whats-new-content {
            max-width: 950px; /* Made the section wider */
            margin: 40px auto 0 auto;
            text-align: left;
        }
            
        .whats-new-content p {
            font-size: 1.05em; /* Slightly smaller font */
            font-style: italic; /* Italicized text */
            line-height: 1.6;
            color: #555;
        }

        footer {
            background-color: #f8f8f8;
            color: #777;
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid #eee;
        }


        /* --- STYLES FOR VERSION HISTORY TIMELINE --- */
        .timeline-container {
            position: relative;
            width: 100%;
            margin: 60px 0;
        }
        .timeline-wrapper {
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: relative;
        }
        /* The line connecting the dots */
        .timeline-wrapper::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 12%; /* Added padding */
            right: 12%;/* Added padding */
            height: 2px;
            background-color: #e0e0e0;
            transform: translateY(-50%);
            z-index: 1;
        }

        .timeline-item {
            text-align: center;
            position: relative;
            z-index: 2; /* Sits on top of the line */
            cursor: pointer;
        }
        
        .timeline-item .timeline-circle {
            display: block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin: 0 auto 15px auto; /* Center the circle and add space below for text */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transition for hover effect */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .timeline-item:hover .timeline-circle {
            transform: scale(1.2);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        
        /* Specific gradient colors for each version's circle */
        .timeline-item:nth-child(1) .timeline-circle { background-image: linear-gradient(45deg, #434343 0%, #000000 100%); }
        .timeline-item:nth-child(2) .timeline-circle { background-image: linear-gradient(45deg, #87CEEB 0%, #4285F4 100%); }
        .timeline-item:nth-child(3) .timeline-circle { background-image: linear-gradient(45deg, #FEE140 0%, #FA709A 100%); }
        .timeline-item:nth-child(4) .timeline-circle { background-image: linear-gradient(45deg, #8820bd 0%, #6720BD 100%); }


        .timeline-item-content h3, .timeline-item-content p {
            margin: 0;
            padding: 0;
        }
        .timeline-item-content h3 {
            font-size: 1.1em;
            margin-bottom: 4px;
            padding-top: 10px; /* Added padding to push it down from the line */
        }
        .timeline-item-content p {
            font-size: 0.9em;
            color: #666;
        }

        /* --- MODAL STYLES FOR TIMELINE --- */
        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .version-modal {
            display: none;
            position: absolute; /* Changed to absolute */
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            overflow: hidden;
            /* Transition properties and border-radius are set by JS */
        }
        
        .version-modal.has-gradient-bg {
            color: #fff;
        }

        .modal-inner-content {
            opacity: 0;
            height: 100%;
            overflow-y: auto;
            box-sizing: border-box;
            padding: 25px 30px;
             /* Transition properties are set by JS */
        }

        .modal-backdrop.show {
            display: block;
            opacity: 1;
        }

        .version-modal.visible {
            display: block;
        }

        .modal-inner-content .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 2em;
            color: #aaa;
            background: none;
            border: none;
            cursor: pointer;
        }

        .version-modal.has-gradient-bg .modal-inner-content .close-btn {
            color: #eee;
        }

        .modal-inner-content .close-btn:hover {
            color: #333;
        }

        .version-modal.has-gradient-bg .modal-inner-content .close-btn:hover {
            color: #fff;
        }

        .modal-inner-content h3 {
            font-family: 'PrimaryFont', sans-serif;
            text-transform: uppercase;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .modal-inner-content p {
            font-style: normal;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        #modalDescription {
            font-size: 0.9em;
            font-style: italic;
        }

        #modalStartDate,
        #modalCreationDate {
            font-family: 'PrimaryFont', sans-serif;
            font-weight: 700;
        }

        .modal-inner-content p strong {
            color: #333;
        }

        .version-modal.has-gradient-bg .modal-inner-content p strong {
             color: #fff;
        }

        .modal-redirect-btn {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 8px;
            background-color: #6720BD;
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            margin-top: 20px;
            float: right;
            transition: background-color 0.3s ease;
            font-family: 'PrimaryFont', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
        }
        .modal-redirect-btn:hover {
            background-color: #4b138f;
        }


    </style>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="../panic-key.js"></script>
</head>
<body>
    <div id="development-disclaimer-overlay">
        <div class="disclaimer-box">
            <h2>A Note on Future Development</h2>
            <p><strong>Heads up!</strong> I am currently hard at work developing <strong>Version 5 of 4SP</strong>, also known as <strong>Project Zirconium</strong>.</p>
            <p>As a result, this current version (v4) will remain online but will no longer be actively updated or accept new requests. The decision to move forward comes from the current design being cluttered, difficult to maintain, and plagued with various bugs that a fresh start will solve.</p>
            <p>For long-time users, think of this update as being similar in scale to the transition from Version 2 to Version 3, but this will be a much more meticulous and comprehensive overhaul that will naturally take longer to complete. Thank you for your understanding and continued support!</p>
            <button id="disclaimer-continue-btn">I Understand</button>
        </div>
    </div>

    <main>
        <section class="hero-section dark-bg">
            <div class="container">
                <h1>4SIMPLEPROBLEMS</h1>
            </div>
        </section>

        <header class="main-header light-bg">
            <div class="container">
                <div class="logo">
                    <img src="images/logo-dark.png" alt="4SP Logo">
                </div>
                <nav class="main-nav">
                    <ul id="mainNavLinks">
                        <li class="dropdown" id="more-dropdown">
                            <a class="dropbtn">MORE</a>
                        </li>
                        <li class="logged-in-link"><a href="logged-in/dashboard.html">DASHBOARD</a></li>
                        </ul>
                </nav>
                <div class="auth-buttons" id="authButtons">
                </div>
            </div>
        </header>

        <section class="news-bar light-bg">
            <div class="container">
                <p>Fast. Secure. Yours.</p>
            </div>
        </section>
        <section class="hp-infra-section light-bg">
            <div class="container">
                <h2>Over 150 users, and counting.</h2>
                <p>Engage in uneducational games, modify your experience, and escape reality.</p>
            </div>
        </section>
        <section class="info-sections light-bg">
            <div class="container">
                <div class="info-item left-image">
                    <div class="info-content"><h3>ABOUT US</h3><p>We are the perfect website to have fun during boring school hours, disrupt everyone that hates these sounds, and to play some games when you have your work done, or don't. I don't care fr.</p></div>
                </div>
                <div class="info-item right-image">
                    <div class="info-content"><h3>SOUNDBOARD</h3><p>Unleash a barrage of sounds to playfully annoy your teachers. Perfect for those moments when you need a little mischief. your teachers will actually become "😡" right to your face.</p></div>
                </div>
                <div class="info-item left-image">
                    <div class="info-content"><h3>OTHER STUFF</h3><p>We have a lot of other features implemented, like an entirely redesigned requests page, playlists page, and other stuff that i felt like adding bc i have free will</p></div>
                </div>
                <div class="info-item right-image">
                    <div class="info-content"><h3>THIS WEBSITE'S GOALS</h3><p>The goals for this website is to make the best, most fun experience for students that don't care about their academic grade, or who just don't care at all. I hate ads, and I love seeing the number of users go up. Alright?</p></div>
                </div>
                <div class="info-item left-image">
                    <div class="info-content"><h3>A NOTE ON PROXIES</h3><p>As a personal project without any income, I unfortunately cannot continue to manage and support the proxy servers. The costs and effort required are significant, especially while also working to support new features and fulfill all of your requests. The proxy services have been archived for now. I sincerely apologize for this inconvenience.</p></div>
                </div>
            </div>
        </section>

        <section class="timeline-section light-bg">
            <div class="container">
                <h2>VERSION HISTORY</h2>
                <div class="timeline-container">
                    <div class="timeline-wrapper">
                        <div class="timeline-item" onclick="showVersionDetails('v1', event)">
                            <div class="timeline-circle"></div>
                            <div class="timeline-item-content">
                                <h3>Version 1</h3>
                                <p>March 13th, 2025</p>
                            </div>
                        </div>
                        <div class="timeline-item" onclick="showVersionDetails('v2', event)">
                             <div class="timeline-circle"></div>
                             <div class="timeline-item-content">
                                <h3>Version 2</h3>
                                <p>April 11th, 2025</p>
                            </div>
                        </div>
                        <div class="timeline-item" onclick="showVersionDetails('v3', event)">
                             <div class="timeline-circle"></div>
                             <div class="timeline-item-content">
                                <h3>Version 3</h3>
                                <p>May 14th, 2025</p>
                            </div>
                        </div>
                        <div class="timeline-item" onclick="showVersionDetails('v4', event)">
                             <div class="timeline-circle"></div>
                             <div class="timeline-item-content">
                                <h3>Version 4</h3>
                                <p>August 23rd, 2025</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="whats-new-section light-bg">
            <div class="container">
                <h2>WHAT'S NEW</h2>
                <div class="whats-new-content">
                    <p>
                        V4 is a massive overhaul focused on security and fun. Accounts are more secure than ever, and we're now verified with Google, so the official logo and title appear when you sign in instead of a generic Firebase URL. The new 'Games' section is packed with curated sites modified for 4SP like StrongdogXP and GN-Math, alongside standalone classics like the original DOOM and Eaglercraft. This is all on top of the redesigned dashboard, enhanced soundboard, and more secure account options. Have fun ig
                    </p>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2025 4SP. All rights reserved.</p>
        </div>
    </footer>

    <div id="mobile-warning-overlay">
        <div class="warning-box">
            <h2>Desktop Recommended</h2>
            <p>This website is best viewed on a desktop or in landscape mode. Some features may not work as expected on a mobile device.</p>
            <button id="continue-btn">Continue Anyway</button>
        </div>
    </div>

    <div id="versionModalBackdrop" class="modal-backdrop"></div>
    <div id="versionModal" class="version-modal">
        <div id="modalInnerContent" class="modal-inner-content">
            <button id="closeModalBtn" class="close-btn">&times;</button>
            <h3 id="modalTitle"></h3>
            <p id="modalStartDate"></p>
            <p id="modalCreationDate"></p>
            <p id="modalDescription"></p>
            <a id="modalRedirectBtn" href="#" target="_blank" rel="noopener noreferrer" class="modal-redirect-btn">Visit Version</a>
        </div>
    </div>

    <div class="dropdown-content" id="more-menu-content">
        <div class="dropdown-header">MORE</div>
        <hr class="dropdown-divider">
        <a href="the-story.html">THE STORY</a>
        <a href="legal.html">LEGAL</a>
        <a href="https://buymeacoffee.com/4simpleproblems" target="_blank" rel="noopener noreferrer">DONATE</a>
    </div>

    <script>
        // --- TIMELINE MODAL SCRIPT ---
        const versionDetails = {
            v1: {
                title: 'Version 1 Details',
                startDate: '<strong>Started:</strong> March 8th, 2025',
                creationDate: '<strong>Released:</strong> March 13th, 2025',
                description: 'This was the initial launch of 4SP. It was a simple page with a basic soundboard and requests page. The foundation of 4SP was laid here.',
                url: 'https://4simpleproblems.github.io/v1'
            },
            v2: {
                title: 'Version 2 Details',
                startDate: '<strong>Started:</strong> March 21th, 2025',
                creationDate: '<strong>Released:</strong> April 11th, 2025',
                description: 'Version 2 introduced many more pages, like experimental music, games, etc. The design was updated to be pill shaped, rounded and user-friendly.',
                url: 'https://4simpleproblems.github.io/v2'
            },
            v3: {
                title: 'Version 3 Details',
                startDate: '<strong>Started:</strong> May 7th, 2025',
                creationDate: '<strong>Released:</strong> May 14th, 2025',
                description: 'This version focused on expanding the features, adding playlists, which was in beta, and improving the overall performance. The website had a redesign of a white, unrounded theme.',
                url: 'https://4simpleproblems.github.io/v3'
            },
            v4: {
                title: 'Version 4 Details',
                startDate: '<strong>Started:</strong> May 26th, 2025',
                creationDate: '<strong>Released:</strong> August 23rd, 2025',
                description: 'The current version. A complete overhaul with a focus on security, fun, and new content like the Games section. The UI was completely redesigned.',
                url: '#'
            }
        };

        const modal = document.getElementById('versionModal');
        const backdrop = document.getElementById('versionModalBackdrop');
        const closeModalBtn = document.getElementById('closeModalBtn');
        let activeCircle = null; // Store the clicked circle element
        let activeModal = false; // Prevents multiple clicks during animation

        function showVersionDetails(versionKey, event) {
            if (activeModal) return;
            activeModal = true;

            const details = versionDetails[versionKey];
            activeCircle = event.currentTarget.querySelector('.timeline-circle');
            if (!details || !activeCircle) {
                activeModal = false;
                return;
            }

            const initialRect = activeCircle.getBoundingClientRect();

            // Get background from circle
            const circleStyle = window.getComputedStyle(activeCircle);
            const bgImage = circleStyle.backgroundImage;

            // Populate content first
            document.getElementById('modalTitle').innerText = details.title;
            document.getElementById('modalStartDate').innerHTML = details.startDate;
            document.getElementById('modalCreationDate').innerHTML = details.creationDate;
            document.getElementById('modalDescription').innerText = details.description;
            const redirectBtn = document.getElementById('modalRedirectBtn');
            redirectBtn.href = details.url;
            redirectBtn.style.display = details.url === '#' ? 'none' : 'inline-block';

            // Set initial state for animation
            modal.style.transition = 'none'; // No transition for initial setup
            const initialTop = initialRect.top + window.scrollY;
            const initialLeft = initialRect.left + window.scrollX;

            modal.style.top = `${initialTop}px`;
            modal.style.left = `${initialLeft}px`;
            modal.style.width = `${initialRect.width}px`;
            modal.style.height = `${initialRect.height}px`;
            modal.style.borderRadius = '15px'; // Start with 15px, as 30x30 with 15px radius is a circle
            modal.style.backgroundImage = bgImage;
            modal.classList.add('has-gradient-bg');
            
            const innerContent = modal.querySelector('.modal-inner-content');
            innerContent.style.opacity = 0;

            modal.classList.add('visible');
            backdrop.classList.add('show');

            // Force reflow to apply initial styles before animating
            requestAnimationFrame(() => {
                modal.style.transition = 'width 0.4s ease, height 0.4s ease, left 0.4s ease';
                
                const finalWidth = 280; 
                const finalHeight = 256; 
                
                modal.style.width = `${finalWidth}px`;
                modal.style.height = `${finalHeight}px`;

                // V4 opens to the left
                if (versionKey === 'v4') {
                    modal.style.left = `${initialLeft - finalWidth + initialRect.width}px`;
                }

                // Fade in content after expansion
                setTimeout(() => {
                    innerContent.style.transition = 'opacity 0.3s ease';
                    innerContent.style.opacity = 1;
                }, 300);
            });
        }

        function hideVersionDetails() {
            if (!activeModal || !activeCircle) return;

            const innerContent = modal.querySelector('.modal-inner-content');

            // 1. Fade out content fast
            innerContent.style.transition = 'opacity 0.1s ease';
            innerContent.style.opacity = 0;
            
            // 2. After content is faded, start shrinking
            setTimeout(() => {
                modal.style.transition = 'width 0.4s ease, height 0.4s ease, top 0.4s ease, left 0.4s ease, border-radius 0.4s ease';
                
                // BUG FIX: Recalculate the circle's current position
                const currentRect = activeCircle.getBoundingClientRect();
                const finalTop = currentRect.top + window.scrollY;
                const finalLeft = currentRect.left + window.scrollX;

                modal.style.top = `${finalTop}px`;
                modal.style.left = `${finalLeft}px`;
                modal.style.width = `${currentRect.width}px`;
                modal.style.height = `${currentRect.height}px`;
                modal.style.borderRadius = '15px'; // Stays 15px, effectively a circle at this size
                
                backdrop.classList.remove('show');
            }, 100); // Short delay for content to fade
            
            // 3. Clean up after all animations are done
            setTimeout(() => {
                modal.classList.remove('visible');
                modal.style.backgroundImage = '';
                modal.classList.remove('has-gradient-bg');
                activeCircle = null; // Clear the active circle
                activeModal = false; // Allow clicking again
            }, 500); // 100ms delay + 400ms transition
        }

        closeModalBtn.addEventListener('click', hideVersionDetails);
        backdrop.addEventListener('click', hideVersionDetails);


        // --- NEW: One-Time Force Logout Script ---
        // This script runs once per user per browser to ensure data consistency
        // by forcing a re-login, which will trigger the account-fixing logic on the login page.
        (function() {
            const forceLogoutKey = 'forceLogoutCompleted_v1';
            // Check if the one-time logout has already been performed.
            if (!localStorage.getItem(forceLogoutKey)) {
                console.log('Performing one-time force logout to ensure data consistency...');
                // Use an auth state observer to ensure Firebase is ready.
                const unsubscribe = firebase.auth().onAuthStateChanged(user => {
                    unsubscribe(); // Stop listening after the first check.
                    if (user) {
                        // If a user is logged in, sign them out.
                        firebase.auth().signOut().then(() => {
                            localStorage.setItem(forceLogoutKey, 'true');
                            window.location.reload();
                        }).catch(error => {
                            // If signout fails for some reason, still set the flag and reload to avoid loops.
                            console.error('Force logout failed, but setting flag to prevent loop:', error);
                            localStorage.setItem(forceLogoutKey, 'true');
                            window.location.reload();
                        });
                    } else {
                        // If no user is logged in, just set the flag.
                        localStorage.setItem(forceLogoutKey, 'true');
                    }
                });
            }
        })();

        // Firebase Authentication Logic
        const authButtonsDiv = document.getElementById('authButtons');
        const loggedInLinks = document.querySelectorAll('.logged-in-link');
        const loggedOutLinks = document.querySelectorAll('.logged-out-link');

        function logout() {
            firebase.auth().signOut().catch(error => console.error('Error logging out:', error));
        }

        firebase.auth().onAuthStateChanged(user => {
            authButtonsDiv.innerHTML = '';
            if (user) {
                authButtonsDiv.innerHTML = `<a href="#" class="btn btn-logout" onclick="logout()">LOGOUT</a>`;
                loggedInLinks.forEach(link => link.style.display = 'inline-block');
                loggedOutLinks.forEach(link => link.style.display = 'none');
            } else {
                authButtonsDiv.innerHTML = `<a href="login.html" class="btn btn-login">LOGIN</a> <a href="signup.html" class="btn btn-signup">SIGN UP</a>`;
                loggedInLinks.forEach(link => link.style.display = 'none');
                loggedOutLinks.forEach(link => link.style.display = 'inline-block');
            }
        });

        // Dropdown Menu & Other Page Logic
        document.addEventListener('DOMContentLoaded', () => {
            // --- NEW: ONE-TIME DEVELOPMENT DISCLAIMER LOGIC ---
            const disclaimerOverlay = document.getElementById('development-disclaimer-overlay');
            const disclaimerContinueBtn = document.getElementById('disclaimer-continue-btn');
            const disclaimerDismissedKey = 'zirconiumDisclaimerDismissed';

            // Check if the disclaimer has been dismissed before
            if (!localStorage.getItem(disclaimerDismissedKey)) {
                disclaimerOverlay.style.display = 'flex';
                document.body.classList.add('no-scroll');
            }

            // Add event listener to the continue button
            if (disclaimerContinueBtn) {
                disclaimerContinueBtn.addEventListener('click', () => {
                    disclaimerOverlay.style.display = 'none';
                    document.body.classList.remove('no-scroll');
                    // Set the flag in localStorage so it doesn't show again
                    localStorage.setItem(disclaimerDismissedKey, 'true');
                });
            }


            // --- DROPDOWN MENU LOGIC ---
            const dropdownTrigger = document.getElementById('more-dropdown');
            const dropdownContent = document.getElementById('more-menu-content');

            if (dropdownTrigger && dropdownContent) {
                let hideTimeout;

                const showMenu = () => {
                    clearTimeout(hideTimeout);
                    const rect = dropdownTrigger.getBoundingClientRect();
                    dropdownContent.style.top = `${window.scrollY + rect.bottom + 10}px`;
                    dropdownContent.style.left = `${rect.left}px`;
                    dropdownContent.classList.add('show');
                };

                const hideMenu = () => {
                    hideTimeout = setTimeout(() => {
                        dropdownContent.classList.remove('show');
                    }, 200);
                };

                dropdownTrigger.addEventListener('mouseenter', showMenu);
                dropdownTrigger.addEventListener('mouseleave', hideMenu);
                
                dropdownContent.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
                dropdownContent.addEventListener('mouseleave', hideMenu);
            }

            // --- ASPECT RATIO WARNING LOGIC ---
            const overlay = document.getElementById('mobile-warning-overlay');
            const continueBtn = document.getElementById('continue-btn');

            function checkAspectRatio() {
                // Aspect Ratio is calculated by width / height.
                // If the result is 1 or less, it means the viewport is square or portrait.
                const aspectRatio = window.innerWidth / window.innerHeight;
                if (aspectRatio <= 1) { 
                    overlay.style.display = 'flex';
                    document.body.classList.add('no-scroll');
                }
            }

            function hideOverlay() {
                overlay.style.display = 'none';
                document.body.classList.remove('no-scroll');
            }

            // Check the aspect ratio as soon as the page is ready
            checkAspectRatio();

            // Add the click event to the continue button
            if (continueBtn) {
                continueBtn.addEventListener('click', hideOverlay);
            }
        });
    </script>
</body>
</html>
